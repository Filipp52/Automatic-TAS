# Automatic-TAS
***
# Документация кода
## Фронт
###### Веб сервер на Flask
#### `main_front.py`:
* Код, который берёт HTML файлы из папки templates и открывает их в ответ на запросы пользователей
> To note: в бэке реализовано очень много функционала, которые должны использоваться во фронте
> (по типу rewrite_worker_params, change_locations и тд...)
> 
> Нам, к сожалению, не хватило времени, чтоб это всё оформить на вебе, но мы обязательно продолжим)
## Фронт-Бэк
###### Соединительная линия между поднятым вебом и данными полученными из бэка
#### `bf_connection.py`:
* Код, который хранит в себе разные функции, которые могут быть импортированы и вызваны в `main_front.py`
> To note: именно в этом файле вы можете просмотреть функции, которые сделаны, но пока что не использованы в вебе
## Бэк
###### Функционал, читающий DataSet и возвращающий сотрудников с задачами
#### `background_package`:
* `distance.py` - работает с расстояниями и геолокациями (используется Яндекс.Карты API, но для уменьшения запросов мы используем `PGC` - описано в разделе 'файлы')
* `load_xlsx.py` - функции, парсящие DataSet.xlsx, сравнивает условия для задачи и возвращает словари с адресами
* `work_with_jmc.py` - функции, которые помогают работать с `JMC` (описано в разделе файлы)
* `work_with_ntt.py` - функции, которые помогают работать с `NTT` (описано в разделе файлы)
#### `main_back.py`:
* Главный исполняемый файл бэка (в который импортированы все функции из всех файлов), запускающийся в 00:00 и создающий задачи сотрудникам
#### `settings.py`:
* Не константные параметры, которые могут изменяться от сервера или даты
> To note: во всех файлах бэка на важных строчках есть комментарии, а у каждой функции есть доккументация
## `main.py`:
* Запустите этот файл и наше приложение будет работать
***
# Файлы:
### JMC - json объект (JsonMemoryCommunicate)
###### Импровизированная база данных (за последние 30 дней)
* Корневые ключи - даты (ГГГГ-ММ-ДД)
* Подключи (на каждый день) - id выездного сотрудника
* На каждом сотруднике есть свой словарь со структурой:
> ФИО
> 
> Грейд
> 
> Кол-во заданий
> 
> Исходная локация
> 
> Задания
>> Адрес задания : {Название задания : Статус}
###### Например:
```json
{"2023-11-07": 
  {"ДНВ_123": {
    "ФИО": "Дерягин Никита Владимирович", 
    "Грейд": "Синьор", 
    "Кол-во заданий": 2, 
    "Исходная локация": "Краснодар, Красная, д. 139", 
    "Задания": {
      "ул. Уральская, д. 162": {"Выезд на точку для стимулирования выдач": "Выполнено"}, 
      "ул. Коммунаров, д. 258": {"Обучение агента": "Не выполнено"}
      }
    }
  }
}
```
#
### NTT - json объект (NotTakenTasks)
###### Файл хранящий не взятые задачи только на актуальную дату
* Ключи - Адреса
* Значения - Массив с названиями заданий
###### Например:
```json
{
  "ул. Уральская, д. 162": ["Выезд на точку для стимулирования выдач"], 
  "ул. Красных Партизан, д. 117": ["Обучение агента", "Доставка карт и материалов"], 
  "ул. Таманская, д. 153 к. 3, кв. 2": ["Обучение агента"],
}
```
#
## PGC - pickle объект (PickleGeoCode)
###### Файл хранящий в себе словарь с решёнными координатами
* Ключи - Адреса
* Значения - Пара (ширина, долгота)
```python
pgc = {
    'тер. Пашковский жилой массив, ул. Крылатая, д. 2': ('45.01144', '39.122574'),
    'Краснодар, В.Н. Мачуги, 41': ('45.012835', '39.071711'),
    'Краснодар, Красная, д. 139': ('45.04496', '38.977047'),
    'ул. Восточно-Кругликовская, д. 64/2': ('45.068257', '39.025637')
}
```
***